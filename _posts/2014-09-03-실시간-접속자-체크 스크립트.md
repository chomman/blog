---
id: 1424
title: 실시간 접속자 체크 스크립트
author: 정태현
layout: post
guid: http://monggu.com/?p=1424
permalink: /%ec%8b%a4%ec%8b%9c%ea%b0%84-%ec%a0%91%ec%86%8d%ec%9e%90-%ec%b2%b4%ed%81%ac-%ec%8a%a4%ed%81%ac%eb%a6%bd%ed%8a%b8/
exclude:
  - 
url:
  - 
hdimage:
  - 
slide_template:
  - default
custom_sidebar:
  - Default
post_video_type:
  - youtube
categories:
  - Linux
---
실시간 접속자 체크 스크립트

80 포트로 들어오는 네트워크 상태를 4초마다 갱신합니다.

네트워크의 상태 변화 과정은 아래와 같습니다.

1.서버가 소켓을 종료할 경우

1.1 ESTABLISHED->FIN\_WAIT\_1->CLOSING->TIME_WAIT->CLOSED

1.2 ESTABLISHED->FIN\_WAIT\_1->FIN\_WAIT\_2->TIME_WAIT->CLOSED

1.3 ESTABLISHED->FIN\_WAIT\_1->TIME_WAIT->CLOSED

2.클라이언트가 소켓을 종료할 경우

ESTABLISHED->CLOSE\_WAIT->LAST\_ACK->CLOSED

<스크립트>

<pre class="lang:sh decode:true">#!/bin/sh
while [ : ]
do
        date
        echo -n "-:80 LISTEN  : " 
        netstat -nap | grep :80 | grep LISTEN | wc -l
        echo -n "-ESTABLISHED : " 
        netstat -nap | grep :80 | grep iESTABLISHED | wc -l
        echo -n "-TIME_WAIT   : "
        netstat -nap | grep :80 | grep TIME_WAIT | wc -l
        echo -n "-CLOSE_WAIT  : "
        netstat -nap | grep :80 | grep CLOSE_WAIT | wc -l
        sleep 4
done</pre>



<!-- SEO Ultimate (http://www.seodesignsolutions.com/wordpress-seo/) - Code Inserter module -->

  
  
<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-4058194403762977" data-ad-slot="4726363844"></ins>  
<!-- /SEO Ultimate -->